jQuery(function(a){function b(){const a=f.val();e.hide(),e.filter(`[data-tax-class=\'${a}\']`).show()}function c(){const b=a(".edi-tax-class-select").val();a.get(wpo_ips_edi.ajaxurl,{action:"wpo_ips_edi_reload_tax_table",nonce:wpo_ips_edi.nonce,tax_class:b},function(c){const d=a(`.edi-tax-class-table[data-tax-class="${b}"]`);d.html(c)})}function d(a){return /^[A-Z]{2}/.test(a)}a("select[name^=\"wpo_ips_edi_tax_settings\"][name$=\"[scheme]\"],   \t\tselect[name^=\"wpo_ips_edi_tax_settings\"][name$=\"[category]\"], \t\tselect[name^=\"wpo_ips_edi_tax_settings\"][name$=\"[reason]\"]").on("change",function(){let b=a(this).data("current"),c=a(this).find("option:selected").val(),d=a(this).closest("td, th").find(".current"),e=`${wpo_ips_edi.new}: <code>${c}</code> <strong>(${wpo_ips_edi.unsaved})</strong>`,f=`${wpo_ips_edi.code}: <code>${b}</code>`;if(c===b?d.html(f):d.html(e),a(this).attr("name").endsWith("[reason]")){let b=wpo_ips_edi.remarks.reason[c];b?a(this).closest("tr").find(".remark").html(b):a(this).closest("tr").find(".remark").html("")}});const e=a(".edi-tax-class-table"),f=a(".edi-tax-class-select");f.on("change",b),b(),a("#edi-show-changelog").on("click",function(b){b.preventDefault(),a("#edi-standard-changelog").slideToggle()}),a("button.button-edi-save-taxes").on("click",function(b){b.preventDefault();const d=a(this),e=d.data("nonce"),f=d.data("action"),g=d.closest("form#wpo-wcpdf-settings"),h=g.serialize(),i=h+"&action="+encodeURIComponent(f)+"&nonce="+encodeURIComponent(e),j=a("#edi-tax-save-notice");a.post(wpo_ips_edi.ajaxurl,i,function(a){const b=a.data||"Unknown response.";let d="notice";d+=a.success?" notice-success":" notice-error",j.removeClass().addClass(d).html(`<p><strong>${b}</strong></p>`).slideDown(),setTimeout(function(){j.slideUp()},5e3),a.success&&c()})}),function(){function b(b){d.hide(),a("#lang-"+b).show()}const c=a(".wpo-ips-edi-language-selector"),d=a(".edi-supplier-identifier");c.length?(c.on("change",function(){b(this.value)}),b(c.val())):1===d.length&&d.show()}(),a("button.button-edi-load-customer-order-identifiers").on("click",function(b){b.preventDefault();const c=a(this),e=c.closest("table"),f=c.closest(".edi-search-wrap").find(":input").val();a.get(wpo_ips_edi.ajaxurl,{action:"wpo_ips_edi_load_customer_order_identifiers",nonce:wpo_ips_edi.nonce,order_id:f},function(b){if(e.find("tbody").empty(),b.success&&b.data&&b.data.data){const c=b.data.data;a.each(c,function(a,b){let c=b.value,f="",g="";c||(f=b.required?"#d63638":"#996800",c=`<span style="color:${f};">${b.required?wpo_ips_edi.missing:wpo_ips_edi.optional}</span>`),"vat_number"===a&&b.value&&!d(b.value)&&(g=`<br><small style="color:#996800;">${wpo_ips_edi.vat_warning}</small>`),e.find("tbody").append(`
						<tr>
							<td>${b.label}</td>
							<td>${c}${g}</td>
						</tr>
					`)})}else{const a=b.data||wpo_ips_edi.error_loading_identifiers;e.find("tbody").append(`<tr><td colspan="2">${a}</td></tr>`)}})}),a("#edi-customer-order-id").on("keydown",function(a){if("Enter"===a.key||13===a.keyCode)return a.preventDefault(),!1})});